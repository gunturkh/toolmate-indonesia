---
interface Props {
  idPrefix?: string;
}

const { idPrefix = "" } = Astro.props;
const prefix = idPrefix ? `${idPrefix}-` : "";
---

<div id={`${prefix}filter-buttons`} class="flex flex-wrap justify-center gap-4 mb-12">
  <button data-filter="all" class={`${prefix}filter-btn active px-4 py-2 bg-brand-navy text-white rounded-full text-sm font-bold transition hover:bg-blue-900`}>
    All Projects
  </button>
  <button data-filter="wtp" class={`${prefix}filter-btn px-4 py-2 bg-slate-100 text-slate-600 rounded-full text-sm font-semibold transition hover:bg-slate-200`}>
    WTP
  </button>
  <button data-filter="hvac" class={`${prefix}filter-btn px-4 py-2 bg-slate-100 text-slate-600 rounded-full text-sm font-semibold transition hover:bg-slate-200`}>
    HVAC
  </button>
  <button data-filter="civil" class={`${prefix}filter-btn px-4 py-2 bg-slate-100 text-slate-600 rounded-full text-sm font-semibold transition hover:bg-slate-200`}>
    Civil
  </button>
  <button data-filter="structure" class={`${prefix}filter-btn px-4 py-2 bg-slate-100 text-slate-600 rounded-full text-sm font-semibold transition hover:bg-slate-200`}>
    Structure
  </button>
  <button data-filter="mne" class={`${prefix}filter-btn px-4 py-2 bg-slate-100 text-slate-600 rounded-full text-sm font-semibold transition hover:bg-slate-200`}>
    M&E
  </button>
</div>

<script define:vars={{ prefix }}>
document.addEventListener('DOMContentLoaded', function() {
  const filterButtons = document.querySelectorAll(`.${prefix}filter-btn`);
  const projectCards = document.querySelectorAll('.project-card');
  const noResults = document.getElementById(`${prefix}no-results`);

  filterButtons.forEach(button => {
    button.addEventListener('click', function() {
      const filter = this.dataset.filter;

      // Update active button styles
      filterButtons.forEach(btn => {
        btn.classList.remove('active', 'bg-brand-navy', 'text-white');
        btn.classList.add('bg-slate-100', 'text-slate-600');
      });
      this.classList.add('active', 'bg-brand-navy', 'text-white');
      this.classList.remove('bg-slate-100', 'text-slate-600');

      // Filter projects
      let visibleCount = 0;
      projectCards.forEach(card => {
        const category = card.dataset.category;
        if (filter === 'all' || category === filter) {
          card.classList.remove('hidden');
          visibleCount++;
        } else {
          card.classList.add('hidden');
        }
      });

      // Show/hide no results message
      if (noResults) {
        if (visibleCount === 0) {
          noResults.classList.remove('hidden');
        } else {
          noResults.classList.add('hidden');
        }
      }
    });
  });
});
</script>
